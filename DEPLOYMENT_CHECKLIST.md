# 🚀 预购按钮修复 - 部署检查清单

## ✅ 修复前检查

- [ ] 确认问题：库存为0时预购按钮不显示
- [ ] 备份当前代码
- [ ] 记录当前版本号

## 📝 代码修改确认

- [x] `extensions/preorder-embed/assets/preorder-universal.js` 已修改
- [x] `public/shopify-integration.js` 已修改
- [x] 代码语法检查通过（无错误）
- [x] 修复逻辑已验证

## 🧪 本地测试

- [ ] 启动开发服务器 `npm run dev`
- [ ] 访问测试页面 `/test-zero-inventory.html`
- [ ] 验证所有测试用例通过
- [ ] 检查浏览器控制台无错误

## 📦 部署步骤

### App Embed部署

- [ ] 进入扩展目录 `cd extensions/preorder-embed`
- [ ] 运行部署命令 `shopify app deploy`
- [ ] 确认部署成功
- [ ] 记录新版本号

### 独立脚本部署（如果使用）

- [ ] 上传 `public/shopify-integration.js` 到CDN/服务器
- [ ] 更新主题中的脚本引用
- [ ] 清除CDN缓存

## 🔍 生产环境测试

### 基础测试

- [ ] 创建测试商品（库存=0）
- [ ] 访问商品页面
- [ ] 确认预购按钮显示
- [ ] 确认预购徽章显示
- [ ] 点击预购按钮测试功能

### 多场景测试

- [ ] 测试 `available = false` 的商品
- [ ] 测试 `inventory_quantity = 0` 的商品
- [ ] 测试 `inventory_quantity < 0` 的商品
- [ ] 测试有库存的商品（不应显示预购）
- [ ] 测试多变体商品的切换

### 兼容性测试

- [ ] 测试桌面浏览器（Chrome, Firefox, Safari）
- [ ] 测试移动浏览器（iOS Safari, Android Chrome）
- [ ] 测试不同主题（如果有多个）
- [ ] 测试不同语言设置

## 🐛 问题排查

如果测试失败，检查：

- [ ] 浏览器控制台是否有错误
- [ ] `window.meta.product` 数据是否正确
- [ ] 预购脚本是否成功加载
- [ ] 缓存是否已清除
- [ ] App Embed是否已启用

## 📊 监控指标

部署后监控以下指标：

- [ ] 预购按钮显示率
- [ ] 预购转化率
- [ ] 错误日志数量
- [ ] 用户反馈

## 🔄 回滚计划

如果出现问题：

- [ ] 准备回滚命令
- [ ] 保存旧版本备份
- [ ] 测试回滚流程
- [ ] 通知相关人员

## 📞 支持准备

- [ ] 准备技术文档链接
- [ ] 准备常见问题解答
- [ ] 准备调试命令
- [ ] 设置监控告警

## ✨ 部署完成确认

- [ ] 所有测试通过
- [ ] 生产环境验证完成
- [ ] 文档已更新
- [ ] 团队已通知
- [ ] 监控已设置

## 📝 部署记录

**部署日期**: _______________  
**部署人员**: _______________  
**版本号**: _______________  
**测试结果**: _______________  
**备注**: _______________

---

## 🎉 部署成功！

恭喜！预购按钮修复已成功部署。现在库存为0的商品应该能正常显示预购功能了。

**下一步：**
1. 持续监控预购功能表现
2. 收集用户反馈
3. 根据需要进行优化

**技术支持文档：**
- [修复说明（中文）](./修复说明_中文.md)
- [详细技术文档](./ZERO_INVENTORY_FIX.md)
- [快速修复指南](./QUICK_FIX_GUIDE.md)
