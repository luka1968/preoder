# 🎯 重要说明：两种使用方式的区别

## ❌ 你之前理解错了什么

你以为需要商家自己在主题中添加代码，**这是错的！**

---

## ✅ 正确的理解

### **方式 A：临时测试（手动添加代码）**
**仅供开发者测试用！**

这是**你作为开发者**在测试时临时使用的方式：
- 直接修改主题代码
- 手动添加 `<script>` 标签
- 用于快速验证功能

**商家不应该用这个方式！**

---

### **方式 B：App Embed（正式使用）** ⭐⭐⭐
**这才是商家使用的方式！**

**商家只需要：**
1. 安装你的 App
2. 在主题编辑器中**点击一个开关**
3. 完成！

**完全不需要写代码！**

---

## 🔄 完整流程说明

### **作为开发者（你）：**

```
1. 开发 App（你已完成）
   ├── 前端脚本：universal-preorder-globo-mode.js
   ├── App Embed：extensions/preorder-embed/
   └── 后端 API：pages/api/

2. 部署到 Vercel（你要做）
   └── git push → 自动部署

3. 发布 App 到 Shopify（你要做）
   └── Shopify Partner Dashboard → 提交审核

4. 商家安装 App（他们自己做）
   └── 在 App Store 点击"安装"
```

---

### **作为商家（你的客户）：**

```
1. 在 Shopify App Store 安装你的 App
   └── 点击"添加应用" → 授权

2. 启用 App Embed（点击开关）
   ├── 进入主题编辑器
   ├── 找到 "App embeds" 区域
   ├── 打开 "PreOrder Pro" 开关 ✅
   └── 点击"保存"

3. 配置预购产品（设置库存）
   ├── 选择产品
   ├── 库存设为 0
   ├── 开启 "Continue selling"
   └── 保存

4. 完成！客户可以预购了 🎉
```

---

## 📱 App Embed 是什么？

**App Embed = Shopify 的官方功能**

它允许你的 App 自动注入代码到商家主题，**无需商家手动修改代码**。

### **工作原理：**

```
当商家启用 App Embed 后：

Shopify 自动在他们的主题中添加：
├── 你的 JavaScript 文件
├── 你的 CSS 样式
└── 你的配置

商家看到的只是一个开关：
┌──────────────────────────┐
│ App embeds              │
├──────────────────────────┤
│ ☑️ PreOrder Pro         │ ← 点这个开关
│   自动预购功能          │
└──────────────────────────┘
```

---

## 🎯 我已经帮你修改好了什么

### **✅ 文件：`extensions/preorder-embed/blocks/app_embed.liquid`**

**修改内容：**

1. **脚本 URL** 从旧的改为新的：
   ```javascript
   // 旧的（Draft Order 模式）
   script.src = 'https://preorder-pro-fix.vercel.app/universal-preorder.js'
   
   // 新的（Globo 模式）✅
   script.src = 'https://shopmall.dpdns.org/universal-preorder-globo-mode.js'
   ```

2. **配置参数** 更新为 Globo 模式：
   ```javascript
   window.PREORDER_CONFIG = {
     shop: '{{ shop.permanent_domain }}',
     apiUrl: 'https://shopmall.dpdns.org/api',
     enabled: true,
     estimatedShippingDate: '2025-12-31',
     showEstimatedDate: true,
     debug: true,
     version: '2.0.0-globo',
     mode: 'globo' // 使用 Globo 模式
   };
   ```

3. **Schema 说明** 更新：
   ```json
   "content": "🚀 Globo 模式：商品自动加入购物车并跳转到 Shopify Checkout，无需商家修改任何代码！"
   ```

---

## 🚀 现在你需要做什么

### **第 1 步：推送代码到 Vercel**

```bash
git add .
git commit -m "Update to Globo mode - App Embed ready"
git push
```

等待 Vercel 自动部署完成（约 2 分钟）

---

### **第 2 步：部署 App Embed 扩展**

App Embed 是 Shopify Extension，需要单独部署：

```bash
cd extensions/preorder-embed
shopify app deploy
```

或者使用你的部署脚本（如果有）

---

### **第 3 步：在测试店铺安装**

1. 访问 Shopify Partner Dashboard
2. 找到你的 App
3. 点击"Test on development store"
4. 选择测试店铺并安装

---

### **第 4 步：启用 App Embed**

安装后会自动跳转到主题编辑器：

1. 左侧找到 **"App embeds"**
2. 打开 **"PreOrder Pro - 预购插件"** ✅
3. 点击 **保存**

---

### **第 5 步：配置测试产品**

1. Products → 选择产品
2. 库存设为 0
3. 开启 "Continue selling when out of stock"
4. 保存

---

### **第 6 步：测试**

1. 访问产品页面
2. 应该看到预购按钮
3. 点击按钮 → 加入购物车 → 跳转 Checkout
4. 完成测试支付（免费测试）

---

## 📊 对比总结

| | 方式 A：手动添加代码 | 方式 B：App Embed ✅ |
|---|---|---|
| **适用对象** | 开发者测试 | 商家使用 |
| **需要写代码？** | ✅ 需要 | ❌ 不需要 |
| **操作难度** | 中等 | 非常简单 |
| **商家喜欢？** | ❌ 不喜欢 | ✅ 喜欢 |
| **推荐？** | 仅测试用 | **强烈推荐** |

---

## ✅ 你现在明白了吗？

**简单来说：**

1. **你**：开发 App，推送到 Vercel，部署 Extension
2. **商家**：安装 App，点击开关，设置产品
3. **完成**：客户可以预购了

**商家全程不需要写任何代码！** 这就是 Shopify App 的标准做法。

---

## 📞 还有问题？

如果你还不确定，我可以：
1. ✅ 帮你检查 App Embed 配置是否正确
2. ✅ 帮你创建部署脚本
3. ✅ 帮你制作商家使用视频教程

**告诉我你需要什么！** 🚀
